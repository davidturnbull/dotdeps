## Iteration 1 - task-001: CLI argument parsing

### Completed
- Set up Cargo project with Rust 2024 edition
- Implemented CLI argument parsing with clap derive macros
- Supports: add, remove, list subcommands and --clean flag
- Parses ecosystem:package@version syntax correctly
- Handles scoped packages (@org/pkg), Go module paths, version prefixes (v)
- Normalizes package names to lowercase and strips v prefix from versions
- 12 unit tests pass

### Key decisions
- Used clap derive API for declarative argument parsing
- DepSpec struct with FromStr for parsing dependency specifications
- Ecosystem enum with FromStr supporting aliases (npm->node, cargo->rust, etc.)
- Handle --clean vs subcommand conflict in main() rather than clap attribute

### Files changed
- Cargo.toml (new)
- src/main.rs (new)
- src/cli.rs (new)
- README.md (new)
- .ralph/prd.json (updated task-001 passes: true)

### Next
- task-002: Implement cache and .deps directory structure

## Iteration 2 - task-002 & task-005: Cache and .deps directory structure

### Completed
- Implemented cache module for ~/.cache/dotdeps/<ecosystem>/<package>/<version>/
- Implemented deps module for .deps/<ecosystem>/<package> symlinks
- Created symlinks with absolute paths to cache
- Windows detection with copy_dir_recursive fallback
- List command with broken symlink detection
- Remove command (removes symlink, preserves cache)
- Clean command (removes entire .deps/)
- Handles nested paths: scoped npm (@org/pkg), Go modules (github.com/org/repo/v2)
- XDG_CACHE_HOME environment variable respected
- 21 unit tests pass

### Key decisions
- Used `dirs` crate for cross-platform home directory detection
- Symlinks use absolute paths for reliability
- Cache existence checked via .git directory presence
- Empty ecosystem directories cleaned up on remove
- path and target fields in DepEntry kept for future debugging use

### Files changed
- Cargo.toml (added dirs dependency)
- src/main.rs (wired up cache and deps modules)
- src/cache.rs (new)
- src/deps.rs (new)
- README.md (updated status)
- .ralph/prd.json (task-002 and task-005 passes: true)

### Verified behavior
- `dotdeps add python:requests@2.31.0` creates symlink at .deps/python/requests
- `dotdeps add node:@org/pkg@4.17.21` handles scoped packages
- `dotdeps add go:github.com/org/repo/v2@1.0.0` handles Go module paths
- `dotdeps list` shows ecosystem:package@version format
- `dotdeps list` detects broken symlinks (cache evicted)
- `dotdeps remove python:requests` removes symlink, preserves cache
- `dotdeps --clean` removes entire .deps/ directory

### Next
- task-003: Implement git cloning with tag resolution

## Iteration 3 - task-003: Git cloning with tag resolution

### Completed
- Created git module with shallow clone functionality (--depth 1)
- Implemented tag resolution order: v{version} -> {version} -> default branch
- Added warning message when falling back to default branch
- Implemented cleanup of partial clone directories on failure
- Added Go ecosystem repo URL detection from module path
  - github.com/* -> https://github.com/*.git
  - golang.org/x/* -> https://go.googlesource.com/*.git
- 22 unit tests pass

### Key decisions
- Used std::process::Command for git operations (no external crate needed)
- CloneResult struct returns whether default branch was used and which ref was cloned
- Go modules get special treatment since package path IS the repo URL
- Other ecosystems return clear error message directing to config.json override
- Parent directories left in cache on failure (empty, no harm)

### Files changed
- src/git.rs (new)
- src/main.rs (wired in git module, added detect_repo_url function)
- README.md (updated status)
- .ralph/prd.json (task-003 passes: true)

### Verified behavior
- `dotdeps add go:github.com/gin-gonic/gin@1.9.1` clones at v1.9.1 tag
- `dotdeps add go:golang.org/x/sync@0.6.0` clones from go.googlesource.com
- Cache hit on second add of same package
- Nonexistent tag falls back to default branch with warning
- Clone failure cleans up partial directory
- Non-Go ecosystems show clear error about missing repo detection

### Next
- task-004: Implement Python ecosystem lockfile parsing and PyPI repo detection
