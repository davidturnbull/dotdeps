{
  "tasks": [
    {
      "id": "task-001",
      "category": "architecture",
      "description": "Set up Cargo project with CLI argument parsing (clap) and basic command structure",
      "steps": [
        "Create Cargo.toml with Rust 2024 edition and clap dependency",
        "Create src/main.rs with CLI argument parsing for add, remove, list, --clean",
        "Parse ecosystem:package@version syntax",
        "Verify `dotdeps add python:requests@2.31.0` parses correctly",
        "Verify `dotdeps list` and `dotdeps remove` commands are recognized",
        "Verify `dotdeps --clean` flag works"
      ],
      "passes": true
    },
    {
      "id": "task-002",
      "category": "architecture",
      "description": "Implement cache and .deps directory structure with symlink/copy creation",
      "steps": [
        "Create cache directory at ~/.cache/dotdeps/<ecosystem>/<package>/<version>/",
        "Create .deps/<ecosystem>/<package> symlinks (or copies on Windows)",
        "Normalize package names to lowercase",
        "Normalize versions (strip v prefix)",
        "Verify symlink points to correct cache location",
        "Verify Windows detection and copy fallback"
      ],
      "passes": true
    },
    {
      "id": "task-003",
      "category": "architecture",
      "description": "Implement git cloning with tag resolution",
      "steps": [
        "Shallow clone repos with --depth 1",
        "Try tag v{version} first, then {version}, then default branch",
        "Warn user when falling back to default branch",
        "Delete partial directory on clone failure",
        "Verify cloning works for a real package (e.g., requests)"
      ],
      "passes": true
    },
    {
      "id": "task-004",
      "category": "functional",
      "description": "Implement Python ecosystem: lockfile parsing and PyPI repo detection",
      "steps": [
        "Parse poetry.lock for version lookup",
        "Parse uv.lock for version lookup",
        "Parse requirements.txt for version lookup",
        "Parse pyproject.toml for version lookup",
        "Detect repo URL from PyPI project_urls",
        "Verify version detection from poetry.lock works",
        "Verify repo detection for 'requests' package works"
      ],
      "passes": true
    },
    {
      "id": "task-005",
      "category": "functional",
      "description": "Implement list and remove commands with broken symlink detection",
      "steps": [
        "List all symlinks in .deps/ with ecosystem:package@version format",
        "Detect and warn on broken symlinks (cache evicted)",
        "Remove symlinks by ecosystem:package",
        "Leave .deps/ directory even if empty",
        "Verify list shows correct packages",
        "Verify remove deletes only the symlink, not cache"
      ],
      "passes": true
    },
    {
      "id": "task-006",
      "category": "functional",
      "description": "Implement Node.js ecosystem: lockfile parsing and npm registry detection",
      "steps": [
        "Parse pnpm-lock.yaml for version lookup",
        "Parse yarn.lock for version lookup",
        "Parse package-lock.json for version lookup",
        "Detect repo URL from npm registry",
        "Handle scoped packages (@org/pkg) correctly",
        "Verify version detection from pnpm-lock.yaml works",
        "Verify repo detection for 'lodash' package works"
      ],
      "passes": true
    },
    {
      "id": "task-007",
      "category": "functional",
      "description": "Implement Rust ecosystem: Cargo.lock parsing and crates.io repo detection",
      "steps": [
        "Parse Cargo.lock for version lookup",
        "Detect repo URL from crates.io registry",
        "Verify version detection from Cargo.lock works",
        "Verify repo detection for 'serde' package works"
      ],
      "passes": true
    },
    {
      "id": "task-008",
      "category": "functional",
      "description": "Implement Ruby ecosystem: Gemfile.lock parsing and RubyGems repo detection",
      "steps": [
        "Parse Gemfile.lock for version lookup",
        "Detect repo URL from RubyGems source_code_uri",
        "Verify version detection from Gemfile.lock works",
        "Verify repo detection for 'rails' package works"
      ],
      "passes": true
    },
    {
      "id": "task-009",
      "category": "functional",
      "description": "Implement Go ecosystem: go.sum parsing",
      "steps": [
        "Parse go.sum for version lookup",
        "Verify version detection from go.sum works",
        "Go repo URL detection already implemented via module path"
      ],
      "passes": true
    },
    {
      "id": "task-010",
      "category": "functional",
      "description": "Implement config file support for cache limits and overrides",
      "steps": [
        "Read ~/.config/dotdeps/config.json",
        "Support cache_limit_gb setting",
        "Support overrides for custom repo URLs",
        "Verify override repo URL is used when detection fails"
      ],
      "passes": true
    },
    {
      "id": "task-011",
      "category": "functional",
      "description": "Implement cache eviction (LRU by filesystem atime)",
      "steps": [
        "Calculate total cache size by summing all package directories",
        "Get last access time (atime) for each cached package",
        "When cache exceeds limit, delete least recently accessed packages first",
        "Run eviction after successful clone in add command",
        "Verify cache eviction deletes old packages when limit exceeded",
        "Handle broken symlinks after eviction (already done via list command)"
      ],
      "passes": true
    },
    {
      "id": "task-012",
      "category": "functional",
      "description": "Handle git dependencies in lockfiles (clone from git URL, use commit hash)",
      "steps": [
        "Detect git dependencies in Python lockfiles (git+https://...)",
        "Detect git dependencies in Node lockfiles",
        "Clone from git URL directly instead of registry lookup",
        "Use commit hash as version in cache path",
        "Checkout specific commit after clone",
        "Verify git dependency cloning works end-to-end"
      ],
      "passes": true
    },
    {
      "id": "task-013",
      "category": "functional",
      "description": "Skip local path dependencies silently",
      "steps": [
        "Detect local path dependencies in Python lockfiles (file:../local-pkg)",
        "Detect local path dependencies in Node lockfiles (link:, file:)",
        "Skip silently with info message when local dep detected",
        "Verify local path deps don't cause errors"
      ],
      "passes": true
    },
    {
      "id": "task-015",
      "category": "functional",
      "description": "Support bun.lock files for Node.js ecosystem",
      "steps": [
        "Parse bun.lock (JSONC format) for version lookup",
        "Add bun.lock to lockfile priority after package-lock.json",
        "Verify version detection from bun.lock works"
      ],
      "passes": true
    },
    {
      "id": "task-016",
      "category": "functional",
      "description": "Implement Swift ecosystem: Package.resolved parsing and repo detection",
      "steps": [
        "Parse Package.resolved (v1 and v2 format) for version lookup",
        "Extract repositoryURL from Package.resolved for repo detection",
        "Find Package.resolved in Xcode project paths",
        "Verify version detection from Package.resolved works",
        "Verify repo detection for swift-argument-parser works"
      ],
      "passes": true
    },
    {
      "id": "task-017",
      "category": "functional",
      "description": "Add --json flag for machine-readable output",
      "steps": [
        "Add --json flag to CLI argument parser",
        "Implement JSON output for add command",
        "Implement JSON output for list command",
        "Implement JSON output for remove command",
        "Verify JSON output is valid and parseable"
      ],
      "passes": false
    },
    {
      "id": "task-018",
      "category": "functional",
      "description": "Add --dry-run flag to preview actions without changes",
      "steps": [
        "Add --dry-run flag to CLI argument parser",
        "Implement dry-run mode for add command (show resolved version, repo URL, actions)",
        "Skip actual cloning and symlink creation in dry-run mode",
        "Verify dry-run shows correct information without side effects"
      ],
      "passes": false
    },
    {
      "id": "task-019",
      "category": "functional",
      "description": "Handle monorepo tag formats (package-version pattern)",
      "steps": [
        "Add {package}-{version} to tag resolution order",
        "Add {package}-v{version} to tag resolution order",
        "Verify tokio-1.0.0 style tags resolve correctly for Rust monorepos",
        "Verify fallback to other formats still works"
      ],
      "passes": true
    }
  ]
}
